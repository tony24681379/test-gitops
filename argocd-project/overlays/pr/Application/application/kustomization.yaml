apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

resources:
- test

patches:
  - patch: |-
      - op: add
        path: /spec/ignoreDifferences
        value:
          - group: apps
            kind: Deployment
            jsonPointers:
            - /spec/replicas
      - op: add
        path: /metadata/finalizers
        value:
          - resources-finalizer.argocd.argoproj.io
      - op: add
        path: /spec/syncPolicy/automated
        value:
          selfHeal: true
          prune: true
    target:
      group: argoproj.io
      kind: Application
